<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <!-- 视口设置：保证在手机端也能自适应显示 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>XX中学学生会 - 学生会成员</title>

  <!-- 引入思源黑体（Noto Sans SC 是思源黑体的 Google Fonts 版本） -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap"
    rel="stylesheet"
  />

  <!-- 引入 Tailwind CSS（CDN 版本） -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- 引入 Axios（用于 AJAX 请求） -->
  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
  <!-- 前后端联动：统一请求后端接口 -->
  <script src="script.js"></script>

  <!-- Tailwind 自定义配置：主色调蓝色 / 白色，字体设置为思源黑体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              DEFAULT: '#2563eb', // 主蓝色
              light: '#60a5fa',   // 浅蓝
              dark: '#1d4ed8'     // 深蓝
            }
          },
          fontFamily: {
            // 使用思源黑体（Noto Sans SC），并设置回退字体
            sans: ['"Noto Sans SC"', 'system-ui', '-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'sans-serif']
          },
          boxShadow: {
            'soft': '0 10px 25px rgba(37, 99, 235, 0.15)' // 柔和蓝色阴影
          }
        }
      }
    }
  </script>

  <style>
    /* 全局字体设置为思源黑体 */
    body {
      font-family: "Noto Sans SC", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
  </style>
</head>
<body class="bg-slate-50 text-gray-900">
  <!-- 整体页面容器：撑满屏幕高度，底部固定在最下方 -->
  <div class="min-h-screen flex flex-col">

    <!-- 顶部导航栏（与 index.html 保持统一，链接已指向对应页面） -->
    <header class="sticky top-0 z-30 bg-white/90 backdrop-blur border-b border-slate-200">
      <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <!-- 左侧 Logo 与标题 -->
          <div class="flex items-center space-x-2">
            <div class="w-9 h-9 rounded-full bg-primary flex items-center justify-center shadow-soft">
              <span class="text-white font-bold text-lg">会</span>
            </div>
            <div>
              <div class="text-lg sm:text-xl font-semibold text-primary-dark">
                XX中学学生会
              </div>
              <div class="hidden sm:block text-xs text-gray-500">
                Student Union of XX Middle School
              </div>
            </div>
          </div>

          <!-- 电脑端导航菜单 -->
          <div class="hidden md:flex items-center space-x-6">
            <!-- 首页 -->
            <a href="index.html"
               class="relative text-sm font-medium text-gray-700 hover:text-primary transition
                      duration-200 ease-out group">
              首页
              <span class="absolute left-0 -bottom-1 h-0.5 w-0 bg-primary group-hover:w-full transition-all duration-200"></span>
            </a>

            <!-- 活动通知 -->
            <a href="activities.html"
               class="relative text-sm font-medium text-gray-700 hover:text-primary transition
                      duration-200 ease-out group">
              活动通知
              <span class="absolute left-0 -bottom-1 h-0.5 w-0 bg-primary group-hover:w-full transition-all duration-200"></span>
            </a>

            <!-- 学生会成员：当前页，做高亮显示 -->
            <a href="members.html"
               class="relative text-sm font-medium text-primary transition
                      duration-200 ease-out group">
              学生会成员
              <!-- 当前页下划线默认展开 -->
              <span class="absolute left-0 -bottom-1 h-0.5 w-full bg-primary transition-all duration-200"></span>
            </a>

            <!-- 意见反馈：跳转 feedback.html -->
            <a href="feedback.html"
               class="relative inline-flex items-center justify-center px-4 py-2 rounded-full
                      bg-primary text-white text-sm font-medium
                      shadow-soft
                      hover:bg-primary-dark hover:-translate-y-0.5 hover:shadow-lg
                      active:translate-y-0
                      transition transform duration-200">
              意见反馈
            </a>
          </div>

          <!-- 手机端汉堡菜单按钮 -->
          <div class="md:hidden">
            <button
              id="mobile-menu-button"
              type="button"
              class="inline-flex items-center justify-center p-2 rounded-md
                     text-gray-700 hover:text-primary hover:bg-primary/10
                     focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2
                     transform transition duration-150 hover:scale-105 active:scale-95"
              aria-controls="mobile-menu"
              aria-expanded="false"
            >
              <!-- 汉堡图标（默认显示） -->
              <svg id="icon-menu" class="h-6 w-6 block" xmlns="http://www.w3.org/2000/svg" fill="none"
                   viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M4 6h16M4 12h16M4 18h16" />
              </svg>
              <!-- 关闭图标（默认隐藏） -->
              <svg id="icon-close" class="h-6 w-6 hidden" xmlns="http://www.w3.org/2000/svg" fill="none"
                   viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>

        <!-- 手机端折叠菜单内容 -->
        <div id="mobile-menu" class="md:hidden hidden border-t border-slate-200 pb-4">
          <div class="pt-2 space-y-1">
            <!-- 首页 -->
            <a href="index.html"
               class="block px-3 py-2 text-base font-medium text-gray-700 hover:bg-primary/10 hover:text-primary
                      transition-colors duration-150">
              首页
            </a>
            <!-- 活动通知 -->
            <a href="activities.html"
               class="block px-3 py-2 text-base font-medium text-gray-700 hover:bg-primary/10 hover:text-primary
                      transition-colors duration-150">
              活动通知
            </a>
            <!-- 学生会成员：当前页，可用主色文字区分 -->
            <a href="members.html"
               class="block px-3 py-2 text-base font-medium text-primary hover:bg-primary/10 hover:text-primary
                      transition-colors duration-150">
              学生会成员
            </a>
            <!-- 意见反馈：跳转 feedback.html -->
            <a href="feedback.html"
               class="block px-3 py-2 text-base font-medium text-gray-700 hover:bg-primary/10 hover:text-primary
                      transition-colors duration-150">
              意见反馈
            </a>
          </div>
        </div>
      </nav>
    </header>

    <!-- 主体内容：按部门分板块展示成员卡片 -->
    <main class="flex-1">
      <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10 lg:py-12">
        <!-- 页面标题与简介 -->
        <div class="mb-6 sm:mb-8">
          <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">
            学生会成员
          </h1>
          <p class="text-sm sm:text-base text-gray-600">
            以下为学生会主要部门的示例成员信息，实际使用时可以根据真实名单进行替换和补充。
          </p>
        </div>

        <!-- 成员按部门展示：由 /api/get_members 动态填充 -->
        <div id="members-root" class="space-y-8 sm:space-y-10">
          <p class="py-8 text-center text-gray-500 text-sm">加载中…</p>
        </div>
      </section>
    </main>

    <!-- 页面底部（与 index.html 保持一致） -->
    <footer class="bg-primary-dark text-white mt-2">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-5 flex flex-col sm:flex-row items-center justify-between gap-2">
        <div class="text-sm sm:text-base font-medium">
          XX中学学生会
        </div>
        <div class="text-xs sm:text-sm text-slate-100">
          联系电话：12345678
        </div>
      </div>
    </footer>
  </div>

  <!-- 页面交互逻辑（JavaScript） -->
  <script>
    // ===============================
    // 1. 手机端汉堡菜单展开/收起
    // ===============================
    (function () {
      var menuButton = document.getElementById('mobile-menu-button');
      var mobileMenu = document.getElementById('mobile-menu');
      var iconMenu = document.getElementById('icon-menu');
      var iconClose = document.getElementById('icon-close');

      if (!menuButton || !mobileMenu) return;

      menuButton.addEventListener('click', function () {
        var isHidden = mobileMenu.classList.contains('hidden');

        if (isHidden) {
          mobileMenu.classList.remove('hidden');
          menuButton.setAttribute('aria-expanded', 'true');
          iconMenu.classList.add('hidden');
          iconClose.classList.remove('hidden');
        } else {
          mobileMenu.classList.add('hidden');
          menuButton.setAttribute('aria-expanded', 'false');
          iconMenu.classList.remove('hidden');
          iconClose.classList.add('hidden');
        }
      });
    })();

    // ===============================
    // 2. 从后端加载成员列表（/api/get_members），按部门分组展示
    // ===============================
    (function () {
      var root = document.getElementById('members-root');
      if (!root) return;
      var deptSubtitle = { '主席团': '负责学生会整体工作的统筹与协调', '学习部': '负责学习经验交流与学风建设', '文体部': '负责文艺演出与体育活动组织' };

      function esc(s) { if (s == null) return ''; return String(s).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;'); }

      getMembers()
        .then(function (response) {
          var arr = (response && response.data) ? response.data : [];
          if (!arr || !arr.length) {
            root.innerHTML = '<p class="py-8 text-center text-gray-500 text-sm">暂无成员</p>';
            return;
          }
          var byDept = {};
          arr.forEach(function (m) {
            var d = m.department || '其他';
            if (!byDept[d]) byDept[d] = [];
            byDept[d].push(m);
          });
          var order = ['主席团', '学习部', '文体部'];
          var rest = Object.keys(byDept).filter(function (k) { return order.indexOf(k) === -1; });
          var depts = order.filter(function (k) { return byDept[k]; }).concat(rest);
          var html = '';
          depts.forEach(function (dept) {
            var sub = deptSubtitle[dept] || '';
            html += '<section class="mb-8 sm:mb-10"><div class="flex items-center justify-between mb-4 sm:mb-5"><h2 class="text-xl sm:text-2xl font-semibold text-gray-900">' + esc(dept) + '</h2>';
            if (sub) html += '<span class="hidden sm:inline-flex items-center text-xs text-gray-500">' + esc(sub) + '</span>';
            html += '</div><div class="grid gap-4 sm:gap-6 sm:grid-cols-2 lg:grid-cols-3">';
            byDept[dept].forEach(function (m, i) {
              var name = esc(m.name);
              var role = esc(m.role);
              var intro = esc(m.intro);
              var img = (m.image_url || '').trim();
              var photo = img
                ? '<div class="h-36 sm:h-40 bg-slate-200 bg-cover bg-center" style="background-image:url(\'' + esc(img) + '\')"></div>'
                : '<div class="h-36 sm:h-40 bg-slate-200 flex items-center justify-center"><div class="w-16 h-16 rounded-full bg-primary flex items-center justify-center shadow-soft"><span class="text-white text-2xl font-semibold">' + (name.charAt(0) || '?') + '</span></div></div>';
              html += '<article class="bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden hover:shadow-md hover:-translate-y-0.5 transition duration-200 flex flex-col">' + photo + '<div class="p-4 sm:p-5 flex-1 flex flex-col"><h3 class="text-sm sm:text-base font-semibold text-gray-900 mb-1">' + name + '</h3><p class="text-xs text-primary mb-2">' + esc(dept) + ' · ' + role + '</p><p class="text-xs sm:text-sm text-gray-600 flex-1">' + intro + '</p></div></article>';
            });
            html += '</div></section>';
          });
          root.innerHTML = html;
        })
        .catch(function (error) {
          console.error('加载成员失败:', error);
          root.innerHTML = '<p class="py-8 text-center text-gray-500 text-sm">加载失败，请刷新重试</p>';
        });
    })();
  </script>
</body>
</html>